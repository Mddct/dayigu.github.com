<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>行星相对地球运动</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="title" content="行星相对地球运动"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2012-09-07 00:10:07 CST"/>
<meta name="author" content="dayigu"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  div.inlinetask {
    padding:10px;
    border:2px solid gray;
    margin:10px;
    background: #ffffcc;
  }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style><link rel="stylesheet" type="text/css" href="css/worg.css"/>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up" style="text-align:right;font-size:70%;white-space:nowrap;">
 <a accesskey="h" href="sitemap.html"> UP </a>
 |
 <a accesskey="H" href="index.html"> HOME </a>
</div>


<div id="content">
<h1 class="title">行星相对地球运动</h1>

<p>从地球上看其他行星的轨迹是什么样的呢？由于行星并不完全在一个平面内运行，而是与黄道有个夹角，这会导致行星的视运动不完全是一个圆。
</p>
<p>
在下图中可以推导行星的相对地球的运动关系。采用直角坐标，原点在太阳S，xy平面在黄道面上，x指向春分点。图中蓝色轨道为地球轨道，地球位置在E；红色轨道为行星M的轨道，行星位置在M。行星的轨道都建华为圆。地球轨道半径为1，行星轨道半径为 r，行星轨道的倾角为 i。此时地球E相对春分点的偏转角为 &alpha; ，M 在黄道面上的投影为 M'，做 M  到 x 轴的垂线 MD，并做图示的各条辅助线。可知 ∠MDM'=i , 令 ∠MEM'=&theta; 。
</p>
<div class="figure">
<p><img src="./img/planet_apparent_motion.png"  alt="./img/planet_apparent_motion.png" /></p>
<p>行星与地球的位置关系</p>
</div>

<p>
由上图可得地球 E 的坐标：
\begin{equation}
E: x_E=\cos\alpha, y_E=\sin\alpha, z_E=0
\end{equation}

行星 M 的坐标：
\begin{equation}
M: x_M = r\cos\beta, y_M=r\sin\beta\cos i, z_M=r\sin\beta \sin i
\end{equation}

因此可得 M 相对 E 的方位：
\begin{equation}
\sin\theta = \frac{z_M}{|ME|},\;\;
\tan\varphi = \frac{y_M-y_E}{x_M-x_E}
\end{equation}

&theta; 和 \varphi 就是 M 在地心黄道坐标系中的经度和纬度，根据这两个值就能画出行星相对地球的轨迹。
</p>
<p>
绘制轨迹的 python 代码：
</p>


<pre class="example">from math import sin, cos, asin, atan2, pi
from mpl_toolkits.mplot3d import Axes3D
import matplotlib.pyplot as plt
import numpy as np

def orientation(r,i,a,b):
    """ """
    i *= pi/180.
    a *= pi/180.
    b *= pi/180.
    xe = cos(a)
    ye = sin(a)
    ze = 0.
    xm = r*cos(b)
    ym = r*sin(b)*cos(i)
    zm = r*sin(i)*sin(b)
    theta = asin(zm/((xe-xm)**2+(ye-ym)**2+zm**2)**0.5)
    phi = atan2(ym-ye,xm-xe)
    return phi,theta # phi*180/pi,theta*180/pi

def trace(r, i, t, n):
    """ """
    theta = [0]*(n*360)
    phi = [0]*(n*360)
    for a in xrange(n*360):
        b = a/t
        phi[a],theta[a] = orientation(r,i,a,b)

    return phi,theta

def plot_trace(r,i,t,n,name='planet', out=None, show_sphere=True):
    """ """
    fig = plt.figure()
    ax = fig.add_subplot(111, projection='3d')

    if show_sphere:
        u = np.linspace(0, 2 * np.pi, 100)
        v = np.linspace(0, np.pi, 100)
        x = 10 * np.outer(np.cos(u), np.sin(v))
        y = 10 * np.outer(np.sin(u), np.sin(v))
        z = 10 * np.outer(np.ones(np.size(u)), np.cos(v))
        ax.plot_wireframe(x, y, z,  rstride=6, cstride=6, color='#a0a0a0')

    phi,theta=trace(r,i,t,n)
    x = 10*np.cos(theta)*np.cos(phi)
    y = 10*np.cos(theta)*np.sin(phi)
    z = 10*np.sin(theta)
    ax.plot(x,y,z, 'r')

    title = '%s: a=%f, i=%f, t=%f, n=%d'%(name,r,i,t,n)
    ax.text2D(0.05, 0.95, title, transform=ax.transAxes)
    if out is None:
        plt.show()
    else:
        plt.savefig(out)

plot_trace(0.387,7.0,0.24,2,'Mercury','img/Mercury_motion.png')
plot_trace(0.723,3.4,0.63,3,'Venus','img/Venus_motion.png')
plot_trace(1.52,1.85,1.88,8,'Mars','img/Mars_motion.png')
plot_trace(5.2,1.3,11.86,15,'Jupiter','img/Jupiter_motion.png')
plot_trace(9.54,2.49,29.46,35,'Saturn','img/Saturn_motion.png')
plot_trace(19.19,0.77,84.0,90,'Uranus','img/Uranus_motion.png')
plot_trace(30.,1.77,164.8,180,'Neptune','img/Neptune_motion.png')

</pre>


<p>
得到的各行星的轨迹如下：
</p>
<div class="figure">
<p><img src="./img/Mercury_motion.png"  alt="./img/Mercury_motion.png" /></p>
<p>水星相对地球的轨迹</p>
</div>


<div class="figure">
<p><img src="./img/Venus_motion.png"  alt="./img/Venus_motion.png" /></p>
<p>金星相对地球的轨迹</p>
</div>


<div class="figure">
<p><img src="./img/Mars_motion.png"  alt="./img/Mars_motion.png" /></p>
<p>火星相对地球的轨迹</p>
</div>


<div class="figure">
<p><img src="./img/Jupiter_motion.png"  alt="./img/Jupiter_motion.png" /></p>
<p>木星相对地球的轨迹</p>
</div>


<div class="figure">
<p><img src="./img/Saturn_motion.png"  alt="./img/Saturn_motion.png" /></p>
<p>土星相对地球的轨迹</p>
</div>

<div class="figure">
<p><img src="./img/Uranus_motion.png"  alt="./img/Uranus_motion.png" /></p>
<p>天王星星相对地球的轨迹</p>
</div>


<div class="figure">
<p><img src="./img/Neptune_motion.png"  alt="./img/Neptune_motion.png" /></p>
<p>海王星相对地球的轨迹</p>
</div>

<p>
所以基本上行星相对于地球的轨迹是个大圆，但都有小的起伏，比如把木星的轨迹放大就能看出来。
</p>
<div class="figure">
<p><img src="./img/Jupiter_motion_a.png"  alt="./img/Jupiter_motion_a.png" /></p>
<p>木星相对地球的轨迹（放大）</p>
</div>

<p>
轨迹的起伏和轨道的倾角有很大关系，倾角越大，则起伏越大。假设火星的倾角变为 30 度，则轨迹为：
</p>
<div class="figure">
<p><img src="./img/Mars_motion_30.png"  alt="./img/Mars_motion_30.png" /></p>
<p>30度倾角的火星相对地球的轨迹</p>
</div>



</div>

<div id="postamble">
<div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'dayigubasket'; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
</body>
</html>
